# Environment Variables Setup

## Quick Start

1. **Copy the template**:
   ```bash
   cp .env.example .env
   ```

2. **Add your API key**:
   Edit `.env` and add your Moonshot API key:
   ```
   MOONSHOT_API_KEY=sk-your-actual-key-here
   ```
   
   **Note**: Moonshot AI provides the Kimi API, so `MOONSHOT_API_KEY` and `KIMI_API_KEY` are the same key. You only need to set one.

3. **Restart the dev server**:
   The `.env` file is automatically loaded by Vite (RPGJS uses Vite).

## How It Works

- **Vite automatically loads `.env` files** when you run `rpgjs dev` or `rpgjs build`
- Variables are available in server-side code via `process.env.VARIABLE_NAME`
- **DO NOT use `VITE_` prefix** for API keys — that exposes them to the client
- The `.env` file is gitignored and will never be committed

## API Key Priority

The LLM test function (`src/agents/core/llm-test.ts`) checks for API keys in this order:
1. `MOONSHOT_API_KEY` (from `.env` or environment)
2. `KIMI_API_KEY` (fallback — same key, different name used by some project scripts)

**Since they're the same key**, you only need to set `MOONSHOT_API_KEY`. The code checks both for compatibility with existing project scripts that might use `KIMI_API_KEY`.

## Testing

After setting up your `.env` file:
1. Start the dev server: `npx rpgjs dev`
2. Connect a player in the browser
3. Check the server console for `[LLM-Test] ✅ Success!` output

## Security Notes

- **Never commit `.env`** — it's in `.gitignore`
- **Never use `VITE_` prefix** for secrets — those are exposed to the browser
- For production, set environment variables directly or use a process manager that loads `.env`
